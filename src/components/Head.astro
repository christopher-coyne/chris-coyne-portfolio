---
import { ViewTransitions } from "astro:transitions";
---

<script is:inline>
  function init() {
    let theme = (() => {
      if (
        typeof localStorage !== "undefined" &&
        localStorage.getItem("theme")
      ) {
        var stored = localStorage.getItem("theme");
        if (stored === "night") return "dark";
        if (stored === "winter") return "light";
        return stored;
      }
    })();
    if (theme) localStorage.setItem("theme", theme);
    document.documentElement.setAttribute("data-theme", theme ?? "dark");
  }
  init();
  document.addEventListener("astro:after-swap", () => {
    init();
  });
</script>

<ViewTransitions fallback="none"/>
