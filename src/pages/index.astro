---
import Layout from "../layouts/Layout.astro";
import { Icon } from "astro-icon/components";

import { getCollection } from "astro:content";

const blogPosts = await getCollection("blog");
let publishedPosts = blogPosts
  .filter((post) => post.data.published)
  .sort((a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime());

function formatDate(dateStr: string) {
  const d = new Date(dateStr);
  return d.toLocaleDateString("en-US", { month: "short", year: "numeric" });
}
---

<Layout title="Christopher Coyne's blog and portfolio">
  <main
    class="flex flex-col w-[90%] max-w-[700px] m-auto text-foreground animate-fade-in-up"
  >
    <section class="pt-8 pb-12">
      <img
        src="/images/mypics/headshot.webp"
        alt="Chris's headshot"
        class="w-16 h-16 rounded-full mb-4"
      />
      <h1 class="text-3xl font-bold tracking-tight">Christopher Coyne</h1>
      <p class="text-foreground-muted mt-1">Software Engineer and Creator</p>
      <div class="flex items-center gap-4 mt-4">
        <a
          href="https://github.com/christopher-coyne"
          target="_blank"
          rel="noopener noreferrer"
          class="text-foreground-muted hover:text-foreground transition-colors"
        >
          <Icon name="mdi:github" size={20} />
        </a>
        <a
          href="mailto:christcoyne@gmail.com"
          class="text-foreground-muted hover:text-foreground transition-colors"
        >
          <Icon name="mdi:email" size={20} />
        </a>
        <a
          href="https://www.linkedin.com/in/christopher-coyne/"
          target="_blank"
          rel="noopener noreferrer"
          class="text-foreground-muted hover:text-foreground transition-colors"
        >
          <Icon name="mdi:linkedin" size={20} />
        </a>
      </div>
    </section>

    <section class="py-8 border-t border-border">
      <h2 class="text-sm font-medium uppercase tracking-widest text-foreground-muted mb-4">About</h2>
      <p class="text-base leading-relaxed">
        Software engineer at Pyyne Digital in NYC. I love designing and building
        products from the ground up.
      </p>
      <p class="text-sm text-foreground-muted mt-3">
        JS · TS · React · NestJS · Express · Tailwind · AWS · Docker · Stripe
      </p>
    </section>

    <section class="py-8 border-t border-border">
      <div class="flex justify-between items-baseline mb-6">
        <h2 class="text-sm font-medium uppercase tracking-widest text-foreground-muted">Writing</h2>
        <a href="/blog" class="text-sm text-foreground-muted hover:text-foreground transition-colors">All posts &rarr;</a>
      </div>
      <ul class="flex flex-col">
        {
          publishedPosts.map((post: any) => (
            <li>
              <a
                href={`/blog/${post.slug}`}
                class="flex justify-between items-baseline py-3 group hover:text-foreground-muted transition-colors"
              >
                <span class="text-base">{post.data.title}</span>
                <span class="text-sm text-foreground-muted ml-4 shrink-0">
                  {formatDate(post.data.date)}
                </span>
              </a>
            </li>
          ))
        }
      </ul>
    </section>

    <section class="py-8 border-t border-border pb-24">
      <p class="text-foreground-muted text-sm">
        Always looking to collaborate · <a href="mailto:christcoyne@gmail.com" class="text-foreground hover:text-foreground-muted transition-colors underline">christcoyne@gmail.com</a>
      </p>
    </section>
  </main>
</Layout>
